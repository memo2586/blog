<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Games101 - Lecture05 Rasterization 1 (Triangles)</title>
    <link href="/2023/12/05/Games101-Lecture-05-Rasterization-1-Triangles/"/>
    <url>/2023/12/05/Games101-Lecture-05-Rasterization-1-Triangles/</url>
    
    <content type="html"><![CDATA[<h1 id="rasterization-1-triangles">Rasterization 1 (Triangles)</h1><h3 id="canonical-cube-to-screen">1. Canonical Cube to Screen</h3><ul><li><p><strong>什么是屏幕？</strong></p><p><img src="Snipaste_2023-11-28_15-36-39.png" style="zoom:33%;" /></p><p>屏幕一般被定义为一个二维数组，从(0,0)开始，每个像素的坐标是其所在方块的左下角的坐标值。</p></li><li><p><strong>如何将标准立方体映射到屏幕上？(视口变换)</strong></p><ul><li><p>改变换与Z轴无关；</p></li><li><p>将 <span class="math inline">\([-1,1]^2\)</span> 变换到 <spanclass="math inline">\([0,width]\times[0,height]\)</span> ： <spanclass="math display">\[M_{viewport}=\begin{pmatrix}    \frac{width}{2} &amp; 0 &amp; 0 &amp; \frac{width}{2} \\    0 &amp; \frac{height}{2} &amp; 0 &amp; \frac{height}{2} \\    0 &amp; 0 &amp; 1 &amp; 0 \\    0 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}\]</span></p></li></ul></li></ul><h3 id="triangles-meshes">2. Triangles MEshes</h3><ul><li><p><strong>为什么三角形会在图形学中得到广泛应用？</strong></p><ul><li>三角形是最基本的多边形；</li><li>可以将其他多边形分解为三角形；</li><li>三角形内部一定是平面的；</li><li>三角形内外的定义十分清晰；</li><li>定义三角形三个顶点的属性，可以有规律地对三角形内部地点地属性进行插值（重心插值）；</li></ul></li><li><p>一种简单的光栅化的方法：采样</p><ul><li><p><strong>什么是采样？</strong></p><p>给定一个连续的函数，对任意一个点询问该点的函数值是多少。采样是将一个函数离散化的过程。</p><p><img src="Snipaste_2023-11-30_10-08-14.png" style="zoom: 25%;" /><spanclass="math inline">\(\Rightarrow\)</span><img src="Snipaste_2023-11-30_10-11-00.png" style="zoom:25%;" /></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs C++"><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> x = <span class="hljs-number">0</span>; x &lt; xmax; x++)&#123;<br><span class="hljs-keyword">for</span>(<span class="hljs-type">int</span> y = <span class="hljs-number">0</span>; y &lt; ymax; y++)&#123;<br>image[x][y] = <span class="hljs-built_in">inside</span>(tri, x + <span class="hljs-number">0.5</span>, y + <span class="hljs-number">0.5</span>);<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure></li><li><p><strong>Bounding Box!</strong> （AABB）</p><p>采样时有许多优化方式，最简单的一种就是 BoundingBox，通过三个顶点的坐标判断循环的范围，减少无效计算。</p><p><img src="src\Snipaste_2023-11-30_10-16-58.png" style="zoom:25%;" /></p></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>计算机图形学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Games101</tag>
      
      <tag>计算机图形学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>hexo_debug</title>
    <link href="/2023/12/05/hexo-debug/"/>
    <url>/2023/12/05/hexo-debug/</url>
    
    <content type="html"><![CDATA[<h4id="记录一下hexo使用过程中遇到的的bug以及解决方法">记录一下hexo使用过程中遇到的的bug以及解决方法</h4><ul><li><p><strong>render LateX公式过程出现错误：parseAggregate: expectedcomma after expression</strong></p><p>Google后发现是LateX公式中要将 '{' 或 '}'符号中间用空格隔开...</p></li></ul><hr /><p>持续更新中....</p>]]></content>
    
    
    <categories>
      
      <category>debug</category>
      
    </categories>
    
    
    <tags>
      
      <tag>hexo</tag>
      
      <tag>debug</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Games101 - Lecture 04 Transformation Cont</title>
    <link href="/2023/12/05/Games101-Lecture-04-Transformation-Cont/"/>
    <url>/2023/12/05/Games101-Lecture-04-Transformation-Cont/</url>
    
    <content type="html"><![CDATA[<h1 id="transformation">Transformation</h1><h3 id="d-moving-transformation">1. 3D Moving Transformation</h3><ul><li><p><strong>简单的三维变换</strong></p><ul><li><p>缩放 <span class="math display">\[S(s_x,s_y,s_z)=\begin{pmatrix}    s_x &amp; 0 &amp; 0 &amp; 0 \\    0 &amp; s_y &amp; 0 &amp; 0 \\    0 &amp; 0 &amp; s_z &amp; 0 \\    0 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}\]</span></p></li><li><p>平移 <span class="math display">\[T(t_x,t_y,t_z)=\begin{pmatrix}    1 &amp; 0 &amp; 0 &amp; t_x \\    0 &amp; 1 &amp; 0 &amp; t_y \\    0 &amp; 0 &amp; 1 &amp; t_z \\    0 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}\]</span></p></li><li><p>简单绕轴旋转 <span class="math display">\[R_x(\alpha)=\begin{pmatrix}    1 &amp; 0 &amp; 0 &amp; 0 \\    0 &amp; \cos\alpha &amp; -\sin\alpha &amp; 0 \\    0 &amp; \sin\alpha &amp; \cos\alpha &amp; 0 \\    0 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}\]</span></p><p><span class="math display">\[R_y(\alpha)=\begin{pmatrix}    \cos\alpha &amp; 0 &amp; \sin\alpha &amp; 0 \\    0 &amp; 1 &amp; 0 &amp; 0 \\    -\sin\alpha &amp; 0 &amp; \cos\alpha &amp; 0 \\    0 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}\]</span></p><p><span class="math display">\[R_z(\alpha)=\begin{pmatrix}    \cos\alpha &amp; -\sin\alpha &amp; 0 &amp; 0 \\    \sin\alpha &amp; \cos\alpha &amp; 0 &amp; 0 \\    0 &amp; 0 &amp; 1 &amp; 0 \\    0 &amp; 0 &amp; 0 &amp; 1\end{pmatrix}\]</span></p></li></ul></li><li><p><strong>罗德里格斯旋转公式 (Rodrigues' RotationFormula)</strong></p><p>定义一个旋转角度 <span class="math inline">\(\alpha\)</span>与一条经过原点的旋转轴 <spanclass="math inline">\(\mathbf{n}\)</span>，则 <spanclass="math display">\[\mathbf{R}(\mathbf{n},\alpha)=\cos(\alpha)~\mathbf{I} + (1-\cos(\alpha))~\mathbf{n}\mathbf{n}^T +\sin\alpha~\underbrace{\begin{pmatrix}  0 &amp; -n_z &amp; -n_y \\  n_z &amp; 0 &amp; -n_x \\  -n_y &amp; n_x &amp; 0\end{pmatrix} }_{\mathbf{N} }\]</span></p></li></ul><hr /><h3 id="viewing-transformation">2. Viewing transformation</h3><ul><li><p><strong>View / Camera transformation</strong></p><p>如何进行视图变换？</p><ul><li><p>定义相机：</p><p><img src="Snipaste_2023-11-27_10-20-49.png" style="zoom: 33%;" /></p><ul><li>位置 <span class="math inline">\(\overrightarrow{e}\)</span></li><li>朝向 <span class="math inline">\(\hat{g}\)</span></li><li>向上的方向 <span class="math inline">\(\hat{t}\)</span></li></ul></li><li><p>为了简化变换，我们可以使相机与模型的相对位置不变，固定相机位置：</p><p><img src="Snipaste_2023-11-27_10-31-54.png" style="zoom:38%;" /></p><ul><li><p>移动并固定相机位置在原点</p></li><li><p>旋转并固定相机为以Y轴为向上方向</p></li><li><p>旋转并固定相机朝向-Z</p></li><li><p>同时变换除相机以外的模型</p><p><img src="Snipaste_2023-11-27_10-37-07.png" style="zoom:33%;" /></p></li></ul><p>由于相机是设定好的，固定的，虚拟出来的，也就是视图变换本质上只是在对模型进行变换，因此模型变换与视图变换常被一起称为模型视图变换。</p></li><li><p>使用数学表示视图变换：</p><p>定义 <spanclass="math inline">\(M_{view}=R_{view}T_{view}\)</span>，</p><ul><li><p>平移到原点 $ T_{view}=</p><span class="math display">\[\begin{pmatrix}1&amp;0&amp;0&amp;-x_e\\0&amp;1&amp;0&amp;-y_e\\0&amp;0&amp;1&amp;-z_e\end{pmatrix}\]</span><p>$</p></li><li><p>旋转 <span class="math inline">\(g\)</span> 到 <spanclass="math inline">\(-Z\)</span>，<spanclass="math inline">\(t\)</span> 到 <spanclass="math inline">\(Y\)</span>，<span class="math inline">\((g\timest)\)</span> 到 <spanclass="math inline">\(X\)</span>，对此我们可以求逆变换：</p><p>旋转 <span class="math inline">\(X\)</span> 到 <spanclass="math inline">\((g\times t)\)</span>，<spanclass="math inline">\(Y\)</span> 到 <spanclass="math inline">\(t\)</span>，<span class="math inline">\(Z\)</span>到 <span class="math inline">\(-g\)</span> ，可得： <spanclass="math display">\[{R_{view} }^{-1}=\begin{bmatrix}  x_{\hat{g}\times\hat{t} } &amp; x_t &amp; x_{-g} &amp; 0 \\  y_{\hat{g}\times\hat{t} } &amp; y_t &amp; y_{-g} &amp; 0 \\  z_{\hat{g}\times\hat{t} } &amp; z_t &amp; z_{-g} &amp; 0 \\  0 &amp; 0 &amp; 0 &amp; 1\end{bmatrix}\]</span> 由于旋转的变换矩阵为正交矩阵，可得： <spanclass="math display">\[{R_{view}={ {(R_{view} }^{-1})} }^T=\begin{bmatrix}  x_{\hat{g}\times\hat{t} } &amp; y_{\hat{g}\times\hat{t} } &amp;z_{\hat{g}\times\hat{t} } &amp; 0 \\  x_t &amp; y_t &amp; z_t &amp; 0 \\  x_{-g} &amp; y_{-g} &amp; z_{-g} &amp; 0 \\  0 &amp; 0 &amp; 0 &amp; 1\end{bmatrix}\]</span></p></li></ul></li></ul></li></ul><hr /><h3 id="projection-transformation">3. Projection Transformation</h3><ul><li><p><strong>什么是投影变换？</strong></p><p>投影变换分为正交投影与透视投影，二者的区别十分明显：</p></li></ul><p><img src="Snipaste_2023-11-28_10-02-59.png" style="zoom:33%;" /></p><ul><li><p><strong>正交投影</strong></p><p>正交投影是一种假设相机处于无限远的投影方式（忽略了模型的前后关系）。</p><ul><li><p>一种简单的正交投影方式：</p><p><img src="Snipaste_2023-11-28_10-09-12.png" style="zoom:33%;" /></p><ul><li><p>固定相机；</p></li><li><p>丢掉 Z 轴；</p></li><li><p>将模型平移与缩放，使其全部位于 <spanclass="math inline">\([-1,1]^2\)</span> 的矩形范围内。</p></li></ul></li><li><p>常用的正交投影的方式：</p><p><img src="Snipaste_2023-11-28_10-18-20.png" style="zoom:33%;" /></p><p>定义一个立方体 <spanclass="math inline">\([l,r]\times[b,t]\times[f,n]\)</span>与一个标准立方体 <span class="math inline">\([-1,1]^3\)</span>，</p><ul><li>通过先平移后缩放的方式，将立方体投影到标准立方体中。</li></ul><p>使用数学表示投影，先将立方体的中心移动到原点，再将其缩放到标准立方体内：<span class="math display">\[M_{ortho}=\begin{bmatrix}    \frac{2}{r-l} &amp; 0 &amp; 0 &amp; 0 \\    0 &amp; \frac{2}{t-b} &amp; 0 &amp; 0 \\    0 &amp; 0 &amp; \frac{2}{n-f} &amp; 0 \\    0 &amp; 0 &amp; 0 &amp; 1\end{bmatrix}\begin{bmatrix}    1 &amp; 0 &amp; 0 &amp; -\frac{l+r}{2} \\    0 &amp; 1 &amp; 0 &amp; -\frac{t+b}{2} \\    0 &amp; 0 &amp; 1 &amp; -\frac{n+f}{2} \\    0 &amp; 0 &amp; 0 &amp; 1\end{bmatrix}\]</span></p></li></ul></li><li><p><strong>透视投影</strong></p><p>透视投影可以达到近大远小的效果。</p><ul><li><p>透视投影的方式：</p><p><img src="Snipaste_2023-11-28_10-35-45.png" style="zoom:33%;" /></p><ul><li><p>思路：将视锥“挤压”成一个立方体，再将立方体正交投影到标准立方体中；（<spanclass="math inline">\(M_{persp}\rightarrow M_{ortho}\)</span>）</p></li><li><p>对于“挤压”的过程，定义近远都平面不变，远平面中心点不变；</p></li><li><p>从侧面看：</p><p><img src="Snipaste_2023-11-28_10-55-30.png" style="zoom:33%;" /></p><p>根据相似三角形的性质，可得 <span class="math display">\[y&#39;=\frac{n}{z}y \\x&#39;=\frac{n}{z}x\]</span> 根据这点，可得投影变换后的坐标： <span class="math display">\[\begin{pmatrix}  x \\ y \\ z \\ 1\end{pmatrix}\Rightarrow\begin{pmatrix}  \frac{n}{z}x \\ \frac{n}{z}y \\ ? \\ 1\end{pmatrix}=\begin{pmatrix}  nx \\ ny \\ ? \\ z\end{pmatrix}\]</span> 再逆向求投影变换的变换矩阵，已知： <spanclass="math display">\[M^{(4\times4)}_{persp\rightarrow ortho}\begin{pmatrix}  x \\ y \\ z \\1\end{pmatrix} =\begin{pmatrix}  nx \\ ny \\ ? \\ z\end{pmatrix}\]</span> 可求得： <span class="math display">\[M^{(4\times4)}_{persp\rightarrow ortho}=\begin{pmatrix}  n &amp; 0 &amp; 0 &amp; 0 \\  0 &amp; n &amp; 0 &amp; 0 \\  ? &amp; ? &amp; ? &amp; ? \\  0 &amp; 0 &amp; 1 &amp; 0\end{pmatrix}\]</span></p></li><li><p>因为近平面上的点不变，设变换一个位于近平面上的点 <spanclass="math inline">\(\begin{pmatrix}x&amp;y&amp;n&amp;1\end{pmatrix}^T\)</span>，可得该点被“压缩”后坐标不变：<span class="math display">\[M^{(4\times4)}_{persp\rightarrow ortho}\begin{pmatrix}  x \\ y \\ n \\ 1\end{pmatrix}=\begin{pmatrix}  n &amp; 0 &amp; 0 &amp; 0 \\  0 &amp; n &amp; 0 &amp; 0 \\  ? &amp; ? &amp; ? &amp; ? \\  0 &amp; 0 &amp; 1 &amp; 0\end{pmatrix}\begin{pmatrix}  x \\ y \\ n \\ 1\end{pmatrix}\Rightarrow\begin{pmatrix}  x \\ y \\ n \\ 1\end{pmatrix}=\begin{pmatrix}  nx \\ ny \\ n^2 \\ n\end{pmatrix}\]</span> 即 <span class="math inline">\(\begin{pmatrix} C &amp; D &amp;A &amp; B \end{pmatrix} \begin{pmatrix} x \\ y \\ n \\ 1 \end{pmatrix} =n^2\)</span> , 由于 x , y 与 n 无关，因此可以确定 C = D = 0 ，但无法确认A 与 B 的值。</p><p>由 <span class="math inline">\(\begin{pmatrix} 0 &amp; 0 &amp; A&amp; B \end{pmatrix} \begin{pmatrix} x \\ y \\ n \\ 1 \end{pmatrix} =n^2\)</span> ，可得 <spanclass="math inline">\(An+B=n^2\)</span>；</p></li><li><p>又因为远平面上的中心点不变，设远平面上中心点为 <spanclass="math inline">\(\begin{pmatrix}0&amp;0&amp;f&amp;1\end{pmatrix}^T\)</span>，同理可得：<span class="math display">\[\begin{pmatrix}      0 \\ 0 \\ f \\ 1  \end{pmatrix}  \Rightarrow  \begin{pmatrix}      0 \\ 0 \\ f \\ 1  \end{pmatrix}  =  \begin{pmatrix}      0 \\ 0 \\ f^2 \\ f  \end{pmatrix}  \Rightarrow  Af+B=f^2\]</span> 联立： <span class="math display">\[An+B=n^2\\  Af+B=f^2\]</span> 可解得： <span class="math display">\[A=n+f\\B=-nf\]</span></p></li><li><p>最后可得，投影变换矩阵为： <span class="math display">\[\begin{pmatrix}  n &amp; 0 &amp; 0 &amp; 0 \\  0 &amp; n &amp; 0 &amp; 0 \\  0 &amp; 0 &amp; n+f &amp; -nf \\  0 &amp; 0 &amp; 1 &amp; 0\end{pmatrix}\]</span></p></li></ul></li></ul></li><li><p><strong>如何定义一个视锥？</strong></p><p><img src="Snipaste_2023-11-28_15-02-47.png" style="zoom:33%;" /></p><ul><li><p>定义视锥的长宽比（aspect）与垂直可视角度（fovY）；</p><p><img src="Snipaste_2023-11-28_15-14-30.png" style="zoom:33%;" /></p></li><li><p>如何将 aspect 与 fovY 转换成 l, r, b, t ？ <spanclass="math display">\[\tan{\frac{fovY}{2} }=\frac{t}{\lvert n \rvert} \\aspect = \frac{r}{t}\]</span></p></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>计算机图形学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Games101</tag>
      
      <tag>计算机图形学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Games101 - Lecture 03 Transformation</title>
    <link href="/2023/12/05/Games101-Lecture-03-Transformation/"/>
    <url>/2023/12/05/Games101-Lecture-03-Transformation/</url>
    
    <content type="html"><![CDATA[<h1 id="transformation">Transformation</h1><h3 id="mvp-transformation">1. MVP Transformation</h3><ul><li><p><strong>什么是MVP变换？</strong></p><p>Moving Transformation + Viewing Transformation + ProjectionTransformation</p></li></ul><hr /><h3 id="d-moving-transformations">2. 2D moving transformations</h3><ul><li><p><strong>使用矩阵表示线性变换</strong></p><ul><li><p>缩放</p><p><img src="Snipaste_2023-11-25_18-12-06.png" alt="Snipaste_2023-11-25_18-12-06" style="zoom: 33%;" /><span class="math display">\[\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}=\begin{bmatrix}    s &amp; 0 \\    0 &amp; s\end{bmatrix}\begin{bmatrix}    x \\    y\end{bmatrix}\]</span></p></li><li><p>缩放（非对称）</p><p><img src="image-20231125181622307.png" style="zoom:33%;" /> <spanclass="math display">\[\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}=\begin{bmatrix}    s_x &amp; 0 \\    0 &amp; s_y\end{bmatrix}\begin{bmatrix}    x \\    y\end{bmatrix}\]</span></p></li><li><p>镜像（反射）</p><p><img src="image-20231125181820508.png" style="zoom:33%;" /> <spanclass="math display">\[\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}=\begin{bmatrix}    -1 &amp; 0 \\    0 &amp; 1\end{bmatrix}\begin{bmatrix}    x \\    y\end{bmatrix}\]</span></p></li><li><p>切变</p><p><img src="image-20231125182005285.png" style="zoom:33%;" /> <spanclass="math display">\[\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}=\begin{bmatrix}    1 &amp; a \\    0 &amp; 1\end{bmatrix}\begin{bmatrix}    x \\    y\end{bmatrix}\]</span></p></li><li><p>旋转</p><p><img src="image-20231125190114296.png" style="zoom:33%;" /> <spanclass="math display">\[\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}=\begin{bmatrix}    \cos\theta &amp; -\sin\theta \\    \sin\theta &amp; \cos\theta\end{bmatrix}\begin{bmatrix}    x \\    y\end{bmatrix}\]</span> 当旋转 <span class="math inline">\(-\theta\)</span>角度时，容易发现： <span class="math display">\[\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}=R_{-45}\cdot\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}=\begin{bmatrix}    \cos\theta &amp; \sin\theta \\    -\sin\theta &amp; \cos\theta\end{bmatrix}\begin{bmatrix}    x \\    y\end{bmatrix}={R_{45}}^T\cdot\begin{bmatrix}    x&#39; \\    y&#39;\end{bmatrix}\]</span> 又因 $ R_{-45}={R_{45}}^{-1}$,</p><p>因此 $ R_{-45}={R_{45}}<sup>{-1}={R_{45}}</sup>T$ ,该变换矩阵为正交矩阵。</p></li></ul></li></ul><hr /><h3 id="homogeneous-coordinates">3. Homogeneous coordinates</h3><ul><li><p><strong>为什么要引入齐次坐标？</strong></p><p><img src="image-20231125193639426.png" style="zoom:33%;" /></p><p>这是一个简单的平移操作 ，我们知道移动后的图像各点坐标为： <spanclass="math display">\[x&#39;=x+t_x \\y&#39;=y+t_y\]</span>但在将其写成矩阵的表示方式时就会发现，不能将其像其他线性变换一样表示出来：<span class="math display">\[\begin{bmatrix}  x&#39; \\  y&#39;\end{bmatrix}=\begin{bmatrix}  a &amp; -b \\  c &amp; d\end{bmatrix}\begin{bmatrix}  x \\  y\end{bmatrix}+\begin{bmatrix}  t_x \\  t_y\end{bmatrix}\]</span>那么有没有一种办法可以<strong>将缩放、旋转等线性变换与平移等非线性变换用一种简单的变换表示</strong>呢？</p><p>为了解决这个问题，我们引入了齐次坐标。</p></li><li><p><strong>什么是齐次坐标？</strong></p><p>在原本坐标的基础上添加一个维度：</p><ul><li>2D的点 <span class="math inline">\(=(x,y,1)^T\)</span></li><li>2D向量 <span class="math inline">\(=(x,y,0)^T\)</span></li></ul><p>因为向量在空间中的位置不同并不会对向量的值产生任何变化，因此向量的新的一维值为0。</p><p><strong>新增的维度的值使得齐次坐标的运算结果依旧满足以下等式</strong></p><ul><li><p><span class="math inline">\(vector + vector =vector\)</span></p></li><li><p><span class="math inline">\(point - point =vector\)</span></p></li><li><p><span class="math inline">\(point + vector =point\)</span></p></li></ul></li><li><p><strong>齐次坐标的扩充定义</strong></p><ul><li><p>在齐次坐标中，当 <span class="math inline">\(w\neq0\)</span>时，<span class="math inline">\(\begin{pmatrix} x \\ y \\ w\end{pmatrix}\)</span> 表示一个坐标为 <spanclass="math inline">\(\begin{pmatrix} x/w \\ y/w \\ 1\end{pmatrix}\)</span> 的二维的点。</p><p>则 <span class="math inline">\(point + point\)</span>的值为两个点的中点。</p></li></ul></li><li><p><strong>使用齐次坐标表示变换</strong></p><ul><li><p>平移 <span class="math display">\[\begin{pmatrix}    x&#39; \\    y&#39; \\    1\end{pmatrix} =\begin{pmatrix}    a &amp; b &amp; t_x \\    c &amp; d &amp; t_y \\    0 &amp; 0 &amp; 1\end{pmatrix}\begin{pmatrix}    x \\    y \\    1\end{pmatrix}\]</span> 通过改变 <span class="math inline">\(a、b、c、d\)</span>的值，可以做到表示线性变换，例如：</p></li><li><p>旋转 <span class="math display">\[\begin{pmatrix}    x&#39; \\    y&#39; \\    1\end{pmatrix} =\begin{pmatrix}    \cos\theta &amp; -\sin\theta &amp; 0 \\    \sin\theta &amp; \cos\theta &amp; 0 \\    0 &amp; 0 &amp; 1\end{pmatrix}\begin{pmatrix}    x \\    y \\    1\end{pmatrix}\]</span></p></li></ul></li></ul><hr /><h3 id="composite-transformation">4. Composite Transformation</h3><ul><li><p><strong>表示变换的合成时遇到的问题？</strong></p><p><img src="Snipaste_2023-11-26_15-12-28.png" alt="Snipaste_2023-11-26_15-12-28" style="zoom:33%;" /></p><p><img src="Snipaste_2023-11-26_15-13-26.png" alt="Snipaste_2023-11-26_15-13-26" style="zoom:33%;" /></p><p>由图可知，相同的变换在使用不同变换顺序的情况下，得到的结果并不相同，即：<span class="math display">\[R_{45}\cdot T_{(1,0)} \neq T_{(1,0)}\cdot R_{45}\]</span>所以，在合成多个变换时，应该注意计算的顺序，顺序为<strong>从向量的左侧最近的变换矩阵开始运算</strong>。</p><p>例如，进行先旋转 <span class="math inline">\(45\degree\)</span>后向右平移 <span class="math inline">\(1\)</span> 个单位距离应表示为：<span class="math display">\[T_{(1,0)}\cdot R_{45} \cdot\begin{bmatrix}  x \\  y \\  1\end{bmatrix}\]</span></p><p>另外，当平移与线性变换表示为同一个矩阵，计算时先进性线性变换，再进行平移变换。</p></li><li><p><strong>合成变换的推广</strong></p><p>对向量 <span class="math inline">\(\overrightarrow{S}\)</span>应用n个变换 <spanclass="math inline">\(A_1,A_2,A_3,...,A_n\)</span>，可以表示为： <spanclass="math display">\[A_n ...A_2\cdot A_1\cdot\overrightarrow{S}\]</span>虽然矩阵的乘法不满足交换律，但满足结合律。即我们可以先将n个变换 <spanclass="math inline">\(A_1,A_2,A_3,...,A_n\)</span>相乘得到一个复杂的矩阵，这个矩阵可以表示一种十分复杂的变换。</p></li><li><p><strong>变换的分解</strong></p><p><img src="Snipaste_2023-11-27_08-18-45.png" alt="Snipaste_2023-11-27_08-18-45" style="zoom:38%;" /></p><p>有些变换可能是不常规的，无法用简单的变换进行转换。对此，我们需要对变换进行分解，例如将以上图形绕<span class="math inline">\(c\)</span> 点旋转，该变换可以分解为：</p><ul><li>将图形平移 <span class="math inline">\(-c\)</span></li><li>旋转图形</li><li>将图形平移 <span class="math inline">\(c\)</span></li></ul><p>即 <span class="math inline">\(T(c)R(\alpha)T(-c)\)</span></p></li></ul><hr /><h3 id="d-transformation">5. 3D Transformation</h3><ul><li><p><strong>三维中的齐次坐标</strong></p><p>同二维的齐次坐标，添加第四维：</p><ul><li>3D的点 $ =(x,y,z,1)$</li><li>3D向量 <span class="math inline">\(=(x,y,z,0)\)</span></li></ul></li></ul>]]></content>
    
    
    <categories>
      
      <category>计算机图形学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Games101</tag>
      
      <tag>计算机图形学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Games101 - Lecture02 Review of Linear Algebra</title>
    <link href="/2023/12/05/Games101-Lecture-02-Review-of-Linear-Algebra/"/>
    <url>/2023/12/05/Games101-Lecture-02-Review-of-Linear-Algebra/</url>
    
    <content type="html"><![CDATA[<h1 id="review-of-linear-algebra">Review of Linear Algebra</h1><h3 id="vector-addition">1. Vector Addition</h3><ul><li><strong>平行四边形法则与三角形法则</strong></li></ul><p><img src="image-20231122225034808.png" alt="image-20231122225034808" style="zoom: 67%;" /></p><ul><li><p><strong>坐标系</strong></p><p><img src="image-20231122232540795.png" alt="image-20231122232540795" style="zoom:67%;" /></p></li></ul><p>​ 缺省时一般认为向量为列向量: <span class="math display">\[\mathbf{A}=\begin{pmatrix}    x \\    y\end{pmatrix}\tag1\]</span></p><p><span class="math display">\[\mathbf{A^T}=\begin{pmatrix}    x &amp; y\end{pmatrix} \tag2\]</span></p><p><span class="math display">\[\|\mathbf{A}\|=\sqrt{x^2+y^2} \tag3\]</span></p><hr /><h3 id="vector-multiplication-dot-product">2. Vector Multiplication (DotProduct)</h3><ul><li><p><strong>点乘的计算</strong></p><p><img src="image-20231122230307232.png" style="zoom:67%;" /></p><p><strong>向量点乘的结果是一个数。</strong></p></li></ul><p><span class="math display">\[\overrightarrow{a}\cdot\overrightarrow{b}=\|\overrightarrow{a}\|\|\overrightarrow{b}\|\cos\theta\tag1\]</span></p><p><span class="math display">\[\cos\theta=\frac{\overrightarrow{a}\cdot\overrightarrow{b}}{\|\overrightarrow{a}\|\|\overrightarrow{b}\|}\tag2\]</span></p><p>​ 当两个向量都是单位向量时（长度都为1）： <spanclass="math display">\[\cos\theta=\hat{a}\cdot\hat{b}\]</span></p><ul><li><p><strong>点乘的性质</strong></p><ul><li><p><spanclass="math inline">\(\overrightarrow{a}\cdot\overrightarrow{b}=\overrightarrow{b}\cdot\overrightarrow{a}\)</span></p></li><li><p><spanclass="math inline">\(\overrightarrow{a}\cdot(\overrightarrow{b}+\overrightarrow{c})=\overrightarrow{a}\cdot\overrightarrow{b}+\overrightarrow{a}\cdot\overrightarrow{c}\)</span></p></li><li><p><spanclass="math inline">\((k\overrightarrow{a})\cdot=\overrightarrow{a}\cdot(k\overrightarrow{a})=k(\overrightarrow{a}\cdot\overrightarrow{b})\)</span></p></li></ul></li><li><p><strong>笛卡尔坐标系下的点乘运算</strong></p></li></ul><p><span class="math display">\[\overrightarrow{a}\cdot\overrightarrow{b}=\begin{pmatrix}    x_a \\    y_a\end{pmatrix}\cdot\begin{pmatrix}    x_b \\    y_b\end{pmatrix}=x_ax_b+y_ay_b\]</span></p><p>​ <strong>点乘最大的作用在于找到两个向量之间的夹角大小。</strong></p><ul><li><strong>通过点乘求向量在另一个向量上的投影</strong></li></ul><p>​点乘的另一个作用是用于<strong>找到一个向量在另一个向量上的投影</strong>：</p><p><img src="image-20231123172442079.png" style="zoom:67%;" /></p><p>​ <span class="math inline">\(\overrightarrow{b}_\bot\)</span> 是<span class="math inline">\(\overrightarrow{b}\)</span> 在 <spanclass="math inline">\(\overrightarrow{a}\)</span> 方向上的投影，因此：<span class="math display">\[\overrightarrow{b_\bot}=k\hat{a}\]</span> ​ 其中 k 的大小为： <span class="math display">\[k=\|\overrightarrow{b_\bot}\|=\|\overrightarrow{b}\|\cos{\theta}\]</span> ​ 利用点乘计算出 <spanclass="math inline">\(\cos{\theta}\)</span> 后便可以求出 <spanclass="math inline">\(\overrightarrow{b_\bot}\)</span> 。</p><p>​<strong>已知向量在另一个向量上的投影后，可以对该向量任意地进行平行与垂直的分解</strong>：</p><p><img src="image-20231123184130756.png" style="zoom:67%;" /></p><ul><li><p><strong>通过点乘计算向量间的位置关系</strong></p><p><img src="image-20231123195107566.png" style="zoom:67%;" /></p><p>​ 以向量 <span class="math inline">\(\overrightarrow{a}\)</span>的方向为基准定义前与后，当一个向量与向量 <spanclass="math inline">\(\overrightarrow{a}\)</span>的点乘大于0时，称该向量位于前方。反之，当一个向量与向量 <spanclass="math inline">\(\overrightarrow{a}\)</span>的点乘小于0时，称该向量位于后方。</p><p>​<strong>两个向量的单位向量的点乘越接近1，则这两个向量在方向上越接近。</strong></p></li></ul><hr /><h3 id="vector-multiplication-times-product">3 Vector Multiplication(times Product)</h3><ul><li><p><strong>叉乘的计算</strong></p><p><img src="image-20231123200453651.png" style="zoom:67%;" /></p></li></ul><p>​<strong>两个向量叉乘的计算结果是一个垂直于这两个向量所在平面的向量。</strong><span class="math display">\[\overrightarrow{a}\times\overrightarrow{b}=-\overrightarrow{b}\times\overrightarrow{a}\tag1\]</span></p><p><span class="math display">\[\|\overrightarrow{a}\times\overrightarrow{b}\|=\|\overrightarrow{a}\|\|\overrightarrow{b}\|\sin{\phi}\tag2\]</span></p><p>​利用叉乘可以建立一个在三维空间中的直角坐标系（使用右手螺旋定则可以确定运算结果的向量的方向）：<span class="math display">\[\overrightarrow{x}\times\overrightarrow{y}=+\overrightarrow{z} \tag1\]</span></p><p><span class="math display">\[\overrightarrow{y}\times\overrightarrow{x}=-\overrightarrow{z} \tag2\]</span></p><p><span class="math display">\[\overrightarrow{y}\times\overrightarrow{z}=+\overrightarrow{x} \tag3\]</span></p><p><span class="math display">\[......\]</span></p><ul><li><p><strong>叉乘的性质</strong></p><ul><li><p><spanclass="math inline">\(\overrightarrow{a}\times\overrightarrow{b}=-\overrightarrow{b}\times\overrightarrow{a}\)</span></p></li><li><p><spanclass="math inline">\(\overrightarrow{a}\times\overrightarrow{a}=\overrightarrow{0}\)</span></p></li><li><p><spanclass="math inline">\(\overrightarrow{a}\times(\overrightarrow{b}+\overrightarrow{c})=\overrightarrow{a}\times\overrightarrow{b}+\overrightarrow{a}\times\overrightarrow{c}\)</span></p></li><li><p><spanclass="math inline">\(\overrightarrow{a}\times(k\overrightarrow{b})=k(\overrightarrow{a}\times\overrightarrow{b})\)</span></p></li></ul></li><li><p><strong>笛卡尔坐标系下的叉乘运算</strong> <spanclass="math display">\[\overrightarrow{a}\times\overrightarrow{b}=\begin{pmatrix}  y_az_b-y_bz_a \\  z_ax_b-x_az_b \\  x_ay_b-y_ax_b\end{pmatrix}\]</span></p></li><li><p><strong>叉乘的作用</strong></p></li></ul><p>​ <strong>判断某一点是否在图形的内部</strong>。</p><p>​ <img src="image-20231124152224648.png" style="zoom:33%;" /></p><p>​ 如图，<spanclass="math inline">\(\overrightarrow{a}\times\overrightarrow{b}\)</span>的值为正，可得 <span class="math inline">\(\overrightarrow{b}\)</span>在 <span class="math inline">\(\overrightarrow{a}\)</span>的左侧，反之同理，可以判断两个向量的相对左右位置。</p><p><img src="image-20231124152552096.png" style="zoom: 33%;" /></p><p>​要判断点P是否在顺序的，首尾相接的三个向量组成的三角形内部，则只需要计算<spanclass="math inline">\(\overrightarrow{AB}\times\overrightarrow{AP}\)</span>、<spanclass="math inline">\(\overrightarrow{BC}\times\overrightarrow{BP}\)</span>、<spanclass="math inline">\(\overrightarrow{CA}\times\overrightarrow{CP}\)</span>的值是否都为正值或负值，即点P都在三个向量的左侧或右侧。</p><hr /><h3 id="orthonormal-bases-and-coordinate-frames">4. Orthonormal basesand coordinate frames</h3><ul><li><p>建立一个直角坐标系，定义： <span class="math display">\[\|\overrightarrow{u}\|=\|\overrightarrow{v}\|=\|\overrightarrow{w}\|=1\tag1\]</span></p><p><span class="math display">\[\overrightarrow{u}\cdot\overrightarrow{v}=\overrightarrow{v}\cdot\overrightarrow{w}=\overrightarrow{u}\cdot\overrightarrow{w}=0\tag2\]</span></p><p><span class="math display">\[\overrightarrow{w}=\overrightarrow{u}\times\overrightarrow{v} \tag3\]</span></p><p>可以使用投影将任意向量分解，如： <span class="math display">\[\overrightarrow{p}=(\overrightarrow{p}\cdot\overrightarrow{u})\overrightarrow{v}+(\overrightarrow{p}\cdot\overrightarrow{v})\overrightarrow{v}+(\overrightarrow{p}\cdot\overrightarrow{w})\overrightarrow{w}\]</span></p></li></ul><hr /><h3 id="matrix">5. Matrix</h3><ul><li><p><strong>矩阵乘法</strong></p><p>设 <span class="math inline">\(A\times B=C\)</span> ，则有 <spanclass="math inline">\(C_{ij}=A_i\cdot B_j\)</span></p></li><li><p><strong>矩阵乘法的性质</strong></p><ul><li>不满足任何交换律</li><li><span class="math inline">\((AB)C = A(BC)\)</span></li><li><span class="math inline">\(A(B+C)=AB+AC\)</span></li><li><span class="math inline">\((A+B)C=AC+BC\)</span></li><li><span class="math inline">\((AB)^\intercal=B^\intercalA^\intercal\)</span></li></ul></li><li><p><strong>矩阵的逆</strong></p><ul><li>单位矩阵是只在对角线上有非零的元素，定义以下单位矩阵：</li></ul><p><span class="math display">\[I_{2\times2}=\begin{pmatrix}  1 &amp; 0 \\  0 &amp; 1 \\\end{pmatrix}\]</span></p><p>​ 则有： <span class="math display">\[AA^{-1}=A^{-1}A=I\]</span></p><ul><li>矩阵的逆的性质： <span class="math display">\[(AB)^{-1}=B^{-1}A^{-1}\]</span></li></ul></li><li><p><strong>将向量的乘积写成矩阵形式</strong></p><ul><li><p>点乘： <span class="math display">\[\overrightarrow{a}\times\overrightarrow{b}=\overrightarrow{a}^T\overrightarrow{b}=\begin{pmatrix}x_a &amp; y_a &amp; z_a\end{pmatrix}\begin{pmatrix}x_a \\y_a \\z_a\end{pmatrix}=(x_ax_b+y_ay_b+z_az_b)\]</span></p></li><li><p>叉乘： <span class="math display">\[\overrightarrow{a}\times\overrightarrow{b}=A^*b=\begin{pmatrix}    0 &amp; -z_a &amp; y_a \\    z_a &amp; 0 &amp; -x_a \\    -y_a &amp; x_a &amp; 0\end{pmatrix}\begin{pmatrix}    x_b \\    y_b \\    z_b\end{pmatrix}\]</span></p></li></ul></li></ul><p>​</p><p>​</p>]]></content>
    
    
    <categories>
      
      <category>计算机图形学</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Games101</tag>
      
      <tag>计算机图形学</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>基于opencv与pyautogui编写的天翼校园掉线自动重连脚本</title>
    <link href="/2023/10/21/%E5%9F%BA%E4%BA%8Eopencv%E4%B8%8Epyautogui%E7%BC%96%E5%86%99%E7%9A%84%E5%A4%A9%E7%BF%BC%E6%A0%A1%E5%9B%AD%E6%8E%89%E7%BA%BF%E8%87%AA%E5%8A%A8%E9%87%8D%E8%BF%9E%E8%84%9A%E6%9C%AC/"/>
    <url>/2023/10/21/%E5%9F%BA%E4%BA%8Eopencv%E4%B8%8Epyautogui%E7%BC%96%E5%86%99%E7%9A%84%E5%A4%A9%E7%BF%BC%E6%A0%A1%E5%9B%AD%E6%8E%89%E7%BA%BF%E8%87%AA%E5%8A%A8%E9%87%8D%E8%BF%9E%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<p>因为下载机上的天翼校园隔三岔五就掉线，所以有了这个程序...</p><p>图形化界面需要用到pyqt5和qt-material</p><p>不会写python，乱写，程序倒是还挺稳定，能用 orz</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># main.py</span><br><span class="hljs-keyword">import</span> sys<br><span class="hljs-keyword">import</span> threading<br><span class="hljs-keyword">import</span> cv2<br><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np<br><span class="hljs-keyword">import</span> pyautogui<br><span class="hljs-keyword">import</span> time<br><span class="hljs-keyword">from</span> PIL <span class="hljs-keyword">import</span> ImageGrab<br><span class="hljs-keyword">import</span> logging<br><span class="hljs-keyword">from</span> PyQt5 <span class="hljs-keyword">import</span> QtWidgets<br><span class="hljs-keyword">from</span> qt_material <span class="hljs-keyword">import</span> apply_stylesheet<br><span class="hljs-keyword">from</span> main_window <span class="hljs-keyword">import</span> Ui_Form<br><br><span class="hljs-comment"># 读取目标图片</span><br>image_message = cv2.imread(<span class="hljs-string">&#x27;message.png&#x27;</span>)<br>image_login = cv2.imread(<span class="hljs-string">&#x27;login.png&#x27;</span>)<br>h1, w1, _ = image_message.shape<br>h2, w2, _ = image_login.shape<br>threshold = <span class="hljs-number">0.6</span><br>run_flag = <span class="hljs-literal">False</span><br>labelEdit = <span class="hljs-literal">None</span><br>errorNum = <span class="hljs-number">0</span><br><br><br><span class="hljs-comment"># 子线程</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">start_threading</span>:<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        self.image = <span class="hljs-literal">None</span><br>        self.run()<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">find</span>(<span class="hljs-params">self, image</span>):<br>        self.image = image<br>        screenshot = <span class="hljs-literal">None</span><br>        <span class="hljs-comment"># 获取屏幕截图</span><br>        <span class="hljs-comment"># screenshot = ImageGrab.grab()</span><br>        <span class="hljs-keyword">try</span>:<br>            screenshot = ImageGrab.grab()<br>        <span class="hljs-keyword">except</span> OSError <span class="hljs-keyword">as</span> OSE:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;self.get_time()&#125;</span>] <span class="hljs-subst">&#123;OSE&#125;</span>&#x27;</span>)<br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> other_err:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;self.get_time()&#125;</span>] <span class="hljs-subst">&#123;other_err&#125;</span>&#x27;</span>)<br><br>        <span class="hljs-comment"># screenshot.save(f&#x27;src/&#123;self.get_time()&#125;.png&#x27;)</span><br>        <span class="hljs-keyword">if</span> screenshot <span class="hljs-keyword">is</span> <span class="hljs-literal">None</span>:<br>            <span class="hljs-keyword">return</span> [-<span class="hljs-number">1</span>, -<span class="hljs-number">1</span>]<br>        screenshot = np.array(screenshot)<br>        <span class="hljs-comment"># 在屏幕截图上搜索目标图片</span><br>        result = cv2.matchTemplate(screenshot, image, cv2.TM_CCOEFF_NORMED)<br>        loc = np.where(result &gt;= threshold)<br>        <span class="hljs-keyword">if</span> <span class="hljs-built_in">len</span>(loc[<span class="hljs-number">0</span>]) &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> <span class="hljs-built_in">len</span>(loc[<span class="hljs-number">1</span>]) &gt; <span class="hljs-number">0</span>:<br>            <span class="hljs-keyword">return</span> [loc[<span class="hljs-number">1</span>][<span class="hljs-number">0</span>], loc[<span class="hljs-number">0</span>][<span class="hljs-number">0</span>]]<br>        <span class="hljs-keyword">else</span>:<br>            <span class="hljs-keyword">return</span> [<span class="hljs-number">0</span>, <span class="hljs-number">0</span>]<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">get_time</span>(<span class="hljs-params">self</span>):<br>        now = time.strftime(<span class="hljs-string">&#x27;%Y-%m-%d %H-%M-%S&#x27;</span>, time.localtime())<br>        <span class="hljs-keyword">return</span> now<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">run</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">try</span>:<br>            <span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><br>                <span class="hljs-keyword">global</span> run_flag, errorNum<br><br>                <span class="hljs-keyword">while</span> run_flag:<br>                    now = self.get_time()<br>                    set_label_text(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;now&#125;</span>]\nchecking...\nerrorNum: <span class="hljs-subst">&#123;errorNum&#125;</span>&#x27;</span>)<br>                    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;now&#125;</span>]\n checking...&#x27;</span>)<br>                    x, y = self.find(image_message)<br><br>                    <span class="hljs-keyword">if</span> x == <span class="hljs-number">0</span>:<br>                        <span class="hljs-comment"># print(f&#x27; running normally!&#x27;)</span><br>                        <span class="hljs-keyword">pass</span><br>                    <span class="hljs-keyword">elif</span> x &lt; <span class="hljs-number">0</span>:<br>                        set_label_text(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;self.get_time()&#125;</span>] 截图失败！&#x27;</span>)<br>                        <span class="hljs-comment"># print(f&#x27;[&#123;self.get_time()&#125;] screen grab failed&#x27;)</span><br>                    <span class="hljs-keyword">else</span>:<br>                        errorNum = errorNum + <span class="hljs-number">1</span><br>                        now = self.get_time()<br>                        set_label_text(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;now&#125;</span>]\n Error! Enable automated scripts...&#x27;</span>)<br>                        <span class="hljs-comment"># print(f&#x27;[&#123;now&#125;]\n Error! Enable automated scripts...&#x27;)</span><br>                        time.sleep(<span class="hljs-number">1</span>)<br>                        <span class="hljs-comment"># print(f&#x27;[message_pos]: &#123;x&#125;,&#123;y&#125;&#x27;)</span><br>                        pyautogui.click(x + w1 // <span class="hljs-number">2</span>, y + h1 // <span class="hljs-number">2</span>)<br>                        time.sleep(<span class="hljs-number">1</span>)<br><br>                        <span class="hljs-keyword">while</span> run_flag:<br>                            x, y = self.find(image_login)<br>                            <span class="hljs-keyword">if</span> x == <span class="hljs-number">0</span>:<br>                                now = self.get_time()<br>                                set_label_text(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;now&#125;</span>]\nError!\ncant not find login button!\ntrying again...&#x27;</span>)<br>                                <span class="hljs-comment"># print(&quot;Error! can&#x27;t not find login! trying again...&quot;)</span><br>                                time.sleep(<span class="hljs-number">3</span>)<br>                            <span class="hljs-keyword">else</span>:<br>                                time.sleep(<span class="hljs-number">1</span>)<br>                                <span class="hljs-comment"># print(f&#x27;[login_pos]: &#123;x&#125;,&#123;y&#125;&#x27;)</span><br>                                pyautogui.click(x + w2 // <span class="hljs-number">2</span>, y + h2 // <span class="hljs-number">2</span>)<br>                                now = self.get_time()<br>                                set_label_text(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;now&#125;</span>]\nSuccess!\nAutomation script completed.&#x27;</span>)<br>                                <span class="hljs-comment"># print(&quot;Success! Automation script completed.&quot;)</span><br>                                <span class="hljs-keyword">break</span><br>                    time.sleep(<span class="hljs-number">3</span>)<br>                time.sleep(<span class="hljs-number">3</span>)<br><br>        <span class="hljs-keyword">except</span> OSError <span class="hljs-keyword">as</span> OSE:<br>            set_label_text(<span class="hljs-string">f&#x27;系统错误: <span class="hljs-subst">&#123;OSE&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;[<span class="hljs-subst">&#123;self.get_time()&#125;</span>]系统错误: <span class="hljs-subst">&#123;OSE&#125;</span>&#x27;</span>)<br><br>        <span class="hljs-keyword">except</span> Exception <span class="hljs-keyword">as</span> other_error:<br>            now = self.get_time()<br>            set_label_text(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;now&#125;</span>未知错误\n：<span class="hljs-subst">&#123;other_error&#125;</span>&#x27;</span>)<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;now&#125;</span>未知错误\n：<span class="hljs-subst">&#123;other_error&#125;</span>&#x27;</span>)<br><br>        <span class="hljs-keyword">finally</span>:<br>            <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;STOP&quot;</span>)<br><br><br><span class="hljs-comment"># 主窗口</span><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">MainWindow</span>(QtWidgets.QWidget, Ui_Form):<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">__init__</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-built_in">super</span>(MainWindow, self).__init__()<br>        self.setupUi(self)<br>        <span class="hljs-keyword">global</span> labelEdit<br>        labelEdit = self.label<br>        apply_stylesheet(app, theme=<span class="hljs-string">&#x27;dark_teal.xml&#x27;</span>)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">click_start_button</span>(<span class="hljs-params">self</span>):<br>        <span class="hljs-keyword">global</span> run_flag<br>        <span class="hljs-keyword">if</span> run_flag:<br>            run_flag = <span class="hljs-literal">False</span><br>            self.startButton.setText(<span class="hljs-string">&quot;RESTART&quot;</span>)<br>            self.label.setText(<span class="hljs-string">&quot;Click button to start.&quot;</span>)<br>        <span class="hljs-keyword">else</span>:<br>            run_flag = <span class="hljs-literal">True</span><br>            self.startButton.setText(<span class="hljs-string">&quot;STOP&quot;</span>)<br>            self.label.setText(<span class="hljs-string">&quot;Running...\n&quot;</span>)<br><br><br>thread = threading.Thread(target=start_threading)<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">set_label_text</span>(<span class="hljs-params">message</span>):<br>    labelEdit.setText(message)<br><br><br><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&#x27;__main__&#x27;</span>:<br>    app = QtWidgets.QApplication(sys.argv)<br><br>    <span class="hljs-comment"># 开启检测子线程</span><br>    thread.daemon = <span class="hljs-literal">True</span><br>    thread.start()<br><br>    test_ui = MainWindow()<br>    test_ui.show()<br><br>    sys.exit(app.exec_())<br></code></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment"># main_window.py</span><br><span class="hljs-keyword">from</span> PyQt5 <span class="hljs-keyword">import</span> QtCore, QtGui, QtWidgets<br><br><br><span class="hljs-keyword">class</span> <span class="hljs-title class_">Ui_Form</span>(<span class="hljs-title class_ inherited__">object</span>):<br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">setupUi</span>(<span class="hljs-params">self, Form</span>):<br>        Form.setObjectName(<span class="hljs-string">&quot;AutoLogin&quot;</span>)<br>        Form.resize(<span class="hljs-number">300</span>, <span class="hljs-number">250</span>)<br>        Form.setMinimumSize(QtCore.QSize(<span class="hljs-number">300</span>, <span class="hljs-number">250</span>))<br>        Form.setMaximumSize(QtCore.QSize(<span class="hljs-number">300</span>, <span class="hljs-number">250</span>))<br>        font = QtGui.QFont()<br>        font.setFamily(<span class="hljs-string">&quot;微软雅黑&quot;</span>)<br>        font.setPointSize(<span class="hljs-number">12</span>)<br>        Form.setFont(font)<br>        Form.setContextMenuPolicy(QtCore.Qt.NoContextMenu)<br>        self.verticalLayoutWidget = QtWidgets.QWidget(Form)<br>        self.verticalLayoutWidget.setGeometry(QtCore.QRect(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">311</span>, <span class="hljs-number">261</span>))<br>        self.verticalLayoutWidget.setObjectName(<span class="hljs-string">&quot;verticalLayoutWidget&quot;</span>)<br>        self.verticalLayout = QtWidgets.QVBoxLayout(self.verticalLayoutWidget)<br>        self.verticalLayout.setContentsMargins(<span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>        self.verticalLayout.setObjectName(<span class="hljs-string">&quot;verticalLayout&quot;</span>)<br>        self.label = QtWidgets.QLabel(self.verticalLayoutWidget)<br>        self.label.setMinimumSize(QtCore.QSize(<span class="hljs-number">0</span>, <span class="hljs-number">180</span>))<br>        self.label.setAlignment(QtCore.Qt.AlignCenter)<br>        self.label.setObjectName(<span class="hljs-string">&quot;label&quot;</span>)<br>        self.verticalLayout.addWidget(self.label)<br>        spacerItem = QtWidgets.QSpacerItem(<span class="hljs-number">20</span>, <span class="hljs-number">25</span>, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Maximum)<br>        self.verticalLayout.addItem(spacerItem)<br>        self.startButton = QtWidgets.QPushButton(self.verticalLayoutWidget)<br>        self.startButton.setMinimumSize(QtCore.QSize(<span class="hljs-number">130</span>, <span class="hljs-number">0</span>))<br>        self.startButton.setMaximumSize(QtCore.QSize(<span class="hljs-number">150</span>, <span class="hljs-number">16777215</span>))<br>        self.startButton.setObjectName(<span class="hljs-string">&quot;startButton&quot;</span>)<br>        self.verticalLayout.addWidget(self.startButton, <span class="hljs-number">0</span>, QtCore.Qt.AlignHCenter)<br>        spacerItem1 = QtWidgets.QSpacerItem(<span class="hljs-number">20</span>, <span class="hljs-number">40</span>, QtWidgets.QSizePolicy.Minimum, QtWidgets.QSizePolicy.Expanding)<br>        self.verticalLayout.addItem(spacerItem1)<br><br>        self.retranslateUi(Form)<br>        self.startButton.clicked.connect(Form.click_start_button) <span class="hljs-comment"># type: ignore</span><br>        QtCore.QMetaObject.connectSlotsByName(Form)<br><br>    <span class="hljs-keyword">def</span> <span class="hljs-title function_">retranslateUi</span>(<span class="hljs-params">self, Form</span>):<br>        _translate = QtCore.QCoreApplication.translate<br>        Form.setWindowTitle(_translate(<span class="hljs-string">&quot;Form&quot;</span>, <span class="hljs-string">&quot;AutoLogin&quot;</span>))<br>        self.label.setText(_translate(<span class="hljs-string">&quot;Form&quot;</span>, <span class="hljs-string">&quot;Click to Start.&quot;</span>))<br>        self.startButton.setText(_translate(<span class="hljs-string">&quot;Form&quot;</span>, <span class="hljs-string">&quot;Start&quot;</span>))<br></code></pre></td></tr></table></figure><p>用到的两张图片分别是天翼校园掉线时的提示窗口上的确认按钮和主程序窗口上的登录按钮，截个图就行。</p>]]></content>
    
    
    <categories>
      
      <category>脚本</category>
      
    </categories>
    
    
    <tags>
      
      <tag>脚本</tag>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>使用WinCDEmu的galgame光盘映像的自动挂载与卸载脚本</title>
    <link href="/2023/10/11/%E4%BD%BF%E7%94%A8WinCDEmu%E7%9A%84galgame%E5%85%89%E7%9B%98%E6%98%A0%E5%83%8F%E7%9A%84%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD%E4%B8%8E%E5%8D%B8%E8%BD%BD%E8%84%9A%E6%9C%AC/"/>
    <url>/2023/10/11/%E4%BD%BF%E7%94%A8WinCDEmu%E7%9A%84galgame%E5%85%89%E7%9B%98%E6%98%A0%E5%83%8F%E7%9A%84%E8%87%AA%E5%8A%A8%E6%8C%82%E8%BD%BD%E4%B8%8E%E5%8D%B8%E8%BD%BD%E8%84%9A%E6%9C%AC/</url>
    
    <content type="html"><![CDATA[<p>挺久之前写的一个简单脚本，偶尔还能用上。</p><p>放在游戏目录下，修改变量值。脚本运行后能做到自动挂载光盘和启动游戏程序，检查到游戏进程关闭时自动卸载光盘。</p><p>光盘的挂载用的是<ahref="https://github.com/sysprogs/WinCDEmu">WinCDEmu</a>，把程序batchmnt.exe添加到用户环境变量。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs bash">@<span class="hljs-built_in">echo</span> off<br><br>::镜像文件路径<br><span class="hljs-built_in">set</span> <span class="hljs-string">&quot;cur_path=%CD%&quot;</span><br>::修改这里<br><span class="hljs-built_in">set</span> <span class="hljs-string">&quot;iso_filename=DC3WY&quot;</span><br><span class="hljs-built_in">set</span> <span class="hljs-string">&quot;gamename=DC3WY&quot;</span><br><br><span class="hljs-built_in">set</span> <span class="hljs-string">&quot;iso_filepath=%cur_path%\%iso_filename%.ISO&quot;</span><br><br>::挂载<br><span class="hljs-built_in">echo</span> MOUNT %iso_filepath% !<br>batchmnt <span class="hljs-string">&quot;%iso_filepath%&quot;</span><br>::等待挂载<br>choice /t 1 /d y /n &gt;nul<br><br>::启动游戏<br>%gamename%.EXE<br><br>:start<br>choice /t 2 /d y /n &gt;nul<br>tasklist|find /i <span class="hljs-string">&quot;%gamename%.EXE&quot;</span><br><span class="hljs-keyword">if</span> %errorlevel% NEQ 0 ( <br>                <span class="hljs-built_in">echo</span> The %gamename% closes !<br>    goto end<br>)<br>goto start  （循环）<br><br>:end<br>batchmnt /unmount <span class="hljs-string">&quot;%iso_filepath%&quot;</span><br><br><span class="hljs-built_in">echo</span> UNMOUNTED %iso_filepath% !<br><br>choice /t 2 /d y /n &gt;nul<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>脚本</category>
      
    </categories>
    
    
    <tags>
      
      <tag>脚本</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
